var populateFontList;(function(){function r(){var e=window.jQuery,t,n,r,i,s,o={mainContainer:{width:"600px","min-height":"220px","background-color":"rgba(200,200,200,0.3)",position:"fixed",zIndex:"999","box-shadow":"1px 1px 5px black",overflow:"visible"},leftContainer:{width:"400px","min-height":"200px","float":"left",overflow:"auto","border-right":"1px solid lightgray"},selectedElement:{border:"3px dotted grey","-webkit-transition":"all 0.2s","-moz-transition":"all 0.2s","-o-transition":"all 0.2s",transition:"all 0.2s ease-in-out"},unselectedElement:{border:"","-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""},selectButton:{background:"rgb(140,180,200)",width:"30%",margin:"8px","border-color":"rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25)",color:"white","text-shadow":"0 -1px 0 rgba(0, 0, 0, 0.25)","box-shadow":"inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05)","border-radius":"4px"},selectButton_selected:{border:"1px solid rgb(143,200,0)"},rightContainer:{padding:"10px","text-align":"center"},selectorDiv:{"background-color":"rgba(255,255,255,0.6)",padding:"5px",cursor:"pointer"},selectorDiv_selected:{"background-color":"rgb(37,141,200)"},addButton:{background:"rgb(143,200,0)",width:"92%",margin:"8px","border-color":"rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25)",color:"white","text-shadow":"0 -1px 0 rgba(0, 0, 0, 0.25)","box-shadow":"inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05)","border-radius":"4px"},deleteButton:{background:"rgb(200,73,20)",width:"20%",margin:"8px","border-color":"rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25)",color:"white","text-shadow":"0 -1px 0 rgba(0, 0, 0, 0.25)","box-shadow":"inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05)","border-radius":"4px"},subsetSelect:{width:"100px"},variantSelect:{width:"100px"},sizeInput:{width:"100px"},selectorInput:{width:"100px"},fontNameSelect:{width:"150px"},fontProviderSelect:{width:"150px"}};n={addButtonClick:function(){var t=r.createSelectorRow(s.addFontConfig());e(t).click()},deleteButtonClick:function(n,r){e(r).remove();t.reset(s.fontConfigs[n]);s.deleteFontConfig(n);i.save()},selectButtonClick:function(n){r.selectElement(function(r){t.reset(s.fontConfigs[n]);e(this).css(o.selectButton_selected);s.fontConfigs[n].selector=r;t.applyFont(s.fontConfigs[n])})},selectorInputChange:function(n,r,i){t.reset(s.fontConfigs[n]);e(r).css(o.selectButton);s.fontConfigs[n].selector=i;t.applyFont(s.fontConfigs[n])},selectorDivClick:function(t,n){e(n).css(o.selectorDiv_selected);e(n).siblings("div").css(o.selectorDiv);s.setActiveConfig(t);s.fontConfigs[t].provider.ui.update(s.fontConfigs[t])},activeCheckClick:function(e,n){s.fontConfigs[e].active=n.checked;t.reset(s.fontConfigs[e]);t.applyFont(s.fontConfigs[e])},fontProviderSelectChange:function(e){s.setActiveProvider(e);var n=s.getActiveConfig(),r,i;if(n){r=n.id;i=n.selector;s.setFontConfig(r,(new s.getActiveProvider).FontConfiguration(r));s.getActiveConfig().selector=i;s.loadWebFont(s.getActiveConfig(),function(){t.applyFont(s.getActiveConfig())})}}};r=function(t){var n={},r,i,u,a,f;n.providerContainer=document.createElement("div");n.createSelectorRow=function(n){var r=document.createElement("div"),s=document.createElement("input"),u=document.createElement("input"),a=document.createElement("button"),f=document.createElement("button"),l=n.id;e(r).attr("id",l+"_selectorDiv").css(o.selectorDiv).click(function(){t.selectorDivClick(l,r)});e(s).attr("type","checkbox").attr("checked","true").click(function(){t.activeCheckClick(l,s)});r.appendChild(s);e(u).attr("id",l+"_selector").attr("class","selector").css(o.selectorInput).attr("placeholder","jQuery Selector").val(n.selector||"").change(function(){t.selectorInputChange(l,f,this.value)});r.appendChild(u);e(f).html("Select Element").css(o.selectButton).click(function(){t.selectButtonClick(l)});r.appendChild(f);e(a).html("Delete").css(o.deleteButton).click(function(){t.deleteButtonClick(l,r)});r.appendChild(a);i.appendChild(r)};n.selectElement=function(t){var n=e("body *").not("#fontmarkletDiv *");n.on("mouseover.fontmarklet",function(r){r.stopPropagation();e(this).css(o.selectedElement);e(this).on("click.fontmarklet",function(r){r.preventDefault();e(this).css(o.unselectedElement);n.off("click.fontmarklet");n.off("mouseover.fontmarklet");n.off("mouseout.fontmarklet");t(this)})});n.on("mouseout.fontmarklet",function(t){t.stopPropagation();e(this).css(o.unselectedElement);e(this).off("click.fontmarklet")})};n.init=function(){var l,c;(function(e){e.fn.drags=function(t){var n;t=e.extend({handle:"",cursor:"move"},t);if(t.handle===""){n=this}else{n=this.find(t.handle)}return n.css("cursor",t.cursor).on("mousedown",function(n){var r,i,s,o,u,a;if(t.handle===""){r=e(this).addClass("draggable")}else{r=e(this).addClass("active-handle").parent().addClass("draggable")}i=r.css("z-index");s=r.outerHeight();o=r.outerWidth();u=r.offset().top+s-n.pageY;a=r.offset().left+o-n.pageX;r.css("z-index",1e3).parents().on("mousemove",function(t){e(".draggable").offset({top:t.pageY+u-s,left:t.pageX+a-o}).on("mouseup",function(){e(this).removeClass("draggable").css("z-index",i)})})}).on("mouseup",function(){if(t.handle===""){e(this).removeClass("draggable")}else{e(this).removeClass("active-handle").parent().removeClass("draggable")}})}})(e);r=document.createElement("div");e(r).attr("id","fontmarkletDiv").css(o.mainContainer);i=document.createElement("div");e(i).css(o.leftContainer);a=document.createElement("button");e(a).attr("id","addFont").html("Add Selector").css(o.addButton).click(t.addButtonClick);i.appendChild(a);i.appendChild(document.createElement("br"));u=document.createElement("div");e(u).css(o.rightContainer);f=document.createElement("select");e(f).attr("class","selectProvider").css(o.fontProviderSelect).change(function(){var n=e(this).val();t.fontProviderSelectChange(n)});for(l in s.providers){if(s.providers.hasOwnProperty(l)){c=document.createElement("option");c.value=l;c.innerHTML=l;f.appendChild(c)}}u.appendChild(f);u.appendChild(n.providerContainer);e(r).drags();r.appendChild(i);r.appendChild(u);document.body.insertBefore(r,document.body.firstChild)};return n}(n);t=function(){var t={};t.applyFont=function(t){i.save();if(t&&t.active){var n=e(t.selector).not("#fontmarkletDiv *");n.css("font-family",t.family);if(t.size){n.css("font-size",t.size)}if(t.weight){n.css("font-weight",t.weight)}if(t.style){n.css("font-style",t.style)}}};t.reset=function(t){e(t.selector).css("font-family","");e(t.selector).css("font-size","");e(t.selector).css("font-weight","");e(t.selector).css("font-style","")};return t}();i=function(){var n={};n.save=function(){var t=e.extend(true,{},s.fontConfigs),n;for(n in t){if(t.hasOwnProperty(n)){t[n].provider=t[n].provider.name;t[n].selector=t[n].selector.nodeName||t[n].selector}}localStorage.fontmarkletFontConfigs=JSON.stringify(t)};n.load=function(){var e,n;if(localStorage.fontmarkletFontConfigs){s.fontConfigs=JSON.parse(localStorage.fontmarkletFontConfigs);for(e in s.fontConfigs){if(s.fontConfigs.hasOwnProperty(e)){n=s.fontConfigs[e];n.provider=s.providers[n.provider];r.createSelectorRow(s.fontConfigs[e]);s.idCounter++;n.provider.ui.update(n);t.applyFont(n)}}}};return n}();s=function(){var e={},t,n;e.providers={};e.fontConfigs={};e.idCounter=0;e.loadRequirements=function(t){function i(e){e.ui.init();e.ui.hide();if(--n===0){t()}}var n=0,r;for(r in e.providers){if(e.providers.hasOwnProperty(r)){if(e.providers[r].loadRequirements){n++;e.providers[r].loadRequirements(i)}}}};e.loadWebFont=function(e,t){e.provider.loadWebFont(e,t)};e.setActiveProvider=function(t){if(n){n.ui.hide()}n=e.providers[t];n.ui.show()};e.getActiveProvider=function(){return n};e.setActiveConfig=function(n){t=e.fontConfigs[n]};e.getActiveConfig=function(){return t};e.setFontConfig=function(e,n){s.fontConfigs[e]=n;if(e===t.id){t=s.fontConfigs[e]}};e.addFontConfig=function(){var t=e.idCounter++;e.fontConfigs[t]=new n.FontConfiguration(t);e.setActiveConfig(t);return e.fontConfigs[t]};e.deleteFontConfig=function(t){e.fontConfigs[t]=undefined};return e}();s.providers.google=function(){function h(e){switch(e){case"regular":return"normal";case"italic":return 400;default:return parseInt(e,10)}}function p(e){if(e.indexOf("regular")!==-1){return"normal"}if(e.indexOf("italic")!==-1){return"italic"}return"normal"}var n={},i,u,a,f,l,c;n.name="google";n.loadWebFont=function(e,t){if(e.family){WebFont.load({google:{families:[e.family+":"+(e.variant||"")+":"+(e.subset||"")]},active:t})}};n.FontConfiguration=function(t){var r={};r.id=t;r.provider=n;r.selector="";r.family=i[e(a).val()].family;r.variant=e(c).val();r.size=f.value;r.weight=h(e(c).val());r.subset=e(l).val();r.active=true;return r};n.ui=function(){var d={};d.show=function(){e(u).show()};d.hide=function(){e(u).hide()};d.init=function(){u=document.createElement("div");a=document.createElement("select");e(a).attr("class","selectFont").css(o.fontNameSelect).change(function(){var r=e(this).val();d.updateSubsets(i[r].subsets);d.updateVariants(i[r].variants);if(s.getActiveConfig()){s.getActiveConfig().family=i[r].family}n.loadWebFont(s.getActiveConfig(),function(){t.applyFont(s.getActiveConfig())})});u.appendChild(a);l=document.createElement("select");e(l).attr("class","subset").css(o.subsetSelect).change(function(){if(s.getActiveConfig()){s.getActiveConfig().subset=this.value}n.loadWebFont(s.getActiveConfig(),function(){t.applyFont(s.getActiveConfig())})});u.appendChild(l);c=document.createElement("select");e(c).attr("class","variant").css(o.variantSelect).change(function(){if(s.getActiveConfig()){s.getActiveConfig().variant=this.value;s.getActiveConfig().weight=h(this.value);s.getActiveConfig().style=p(this.value)}n.loadWebFont(s.getActiveConfig(),function(){t.applyFont(s.getActiveConfig())})});u.appendChild(c);f=document.createElement("input");e(f).attr("class","fontSize").css(o.sizeInput).attr("placeholder","Font size in px").change(function(){s.getActiveConfig().size=this.value;t.applyFont(s.getActiveConfig())});u.appendChild(f);r.providerContainer.appendChild(u);var v,m=i.length,g;for(v=0;v<m;v++){g=document.createElement("option");g.innerHTML=i[v].family;g.title=i[v].family;g.value=v;a.appendChild(g)}d.updateSubsets(i[0].subsets);d.updateVariants(i[0].variants);n.loadWebFont(new n.FontConfiguration(-1))};d.updateSubsets=function(t){var n,r=t.length,i;e(l).empty();for(n=0;n<r;n++){i=document.createElement("option");i.innerHTML=t[n];i.value=t[n];l.appendChild(i)}if(s.getActiveConfig()){s.getActiveConfig().subset=t[0]}};d.updateVariants=function(t){var n,r=t.length,i;e(c).empty();for(n=0;n<r;n++){i=document.createElement("option");i.innerHTML=t[n];i.value=t[n];c.appendChild(i)}if(s.getActiveConfig()){s.getActiveConfig().weight=h(t[0]);s.getActiveConfig().style=p(t[0])}};d.update=function(t){e(a).children("option[title='"+t.family+"']").prop("selected",true);d.updateSubsets(i[e(a).val()].subsets);d.updateVariants(i[e(a).val()].variants);e(l).children("option[value='"+t.subset+"']").prop("selected",true);e(c).children("option[value='"+t.variant+"']").prop("selected",true)};return d}();n.loadRequirements=function(t){var r=document.createElement("script"),s;r.src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";r.type="text/javascript";r.async="true";r.onload=function(){e.getJSON("https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyBRh3XwaTyAoCjBuAFQ6syYtRjRRdeJb4o&callback=?",function(e){i=e.items;t(n)})};s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(r,s)};return n}();s.providers.local=function(){var n={},i,u,a,f;n.name="local";n.loadWebFont=function(e,t){t()};n.FontConfiguration=function(t){var r={};r.id=t;r.provider=n;r.selector="";r.family=i[e(a).val()];r.size=f.value;r.active=true;return r};n.ui=function(){var n={};n.show=function(){e(u).show()};n.hide=function(){e(u).hide()};n.init=function(){u=document.createElement("div");a=document.createElement("select");e(a).attr("class","selectFont").css(o.fontNameSelect).change(function(){var n=e(this).val();if(s.getActiveConfig()){s.getActiveConfig().family=i[n]}t.applyFont(s.getActiveConfig())});u.appendChild(a);f=document.createElement("input");e(f).attr("class","fontSize").css(o.sizeInput).attr("placeholder","Font size in px").change(function(){s.getActiveConfig().size=this.value;t.applyFont(s.getActiveConfig())});u.appendChild(f);r.providerContainer.appendChild(u)};n.update=function(t){e(a).children("option[title='"+t.family+"']").prop("selected",true)};return n}();n.loadRequirements=function(e){populateFontList=function(e){i=e;var t,n=i.length,r;for(t=0;t<n;t++){r=document.createElement("option");r.innerHTML=i[t];r.title=i[t];r.value=t;a.appendChild(r)}};var t=document.createElement("embed");t.setAttribute("width","1");t.setAttribute("height","1");t.setAttribute("src","FontList.swf");document.body.appendChild(t);e(n)};return n}();r.init();s.loadRequirements(function(){s.setActiveProvider("google");i.load()})}var e="1.8.3",t,n=false;if(window.jQuery===undefined||window.jQuery.fn.jquery<e){t=document.createElement("script");t.src="https://ajax.googleapis.com/ajax/libs/jquery/"+e+"/jquery.min.js";t.onload=t.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){n=true;r()}};document.getElementsByTagName("head")[0].appendChild(t)}else{r()}})()